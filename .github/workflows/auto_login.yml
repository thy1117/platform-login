name: Auto Login

on:
  schedule:
    # 姣?0澶╄繍琛屼竴娆?(姣忔湀 1, 11, 21 鏃?UTC 00:00)
    - cron: '0 0 1,11,21 * *'
  workflow_dispatch:  # 鏀寔鎵嬪姩瑙﹀彂

jobs:
  login:
    runs-on: ubuntu-latest
    timeout-minutes: 15
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt
          playwright install chromium
          playwright install-deps chromium
      
      - name: Run auto login script
        env:
          GH_USERNAME: ${{ secrets.GH_USERNAME }}
          GH_PASSWORD: ${{ secrets.GH_PASSWORD }}
          GH_2FA_SECRET: ${{ secrets.GH_2FA_SECRET }}
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        run: python scripts/auto_login.py
